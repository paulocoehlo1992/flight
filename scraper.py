Created on Tue Feb 28 17:45:51 2017 

@author: Vishal_Oben

"""
from pyflightdata import *
import pandas as pd
from pymongo import MongoClient
import time 
client=MongoClient()
db=client.flight_data
collection_1=db.flight_data_collection


updated_tail=['VT-IAL','VT-AII',
 'VT-IAN',
 'VT-IAO',
 'VT-IAP',
 'VT-IAQ',
 'VT-IAR',
 'VT-IAS',
 'VT-IAX',
 'VT-IAY',
 'VT-IDA',
 'VT-IDB',
 'VT-IDC',
 'VT-IDD',
 'VT-IDE',
 'VT-IDF',
 'VT-IDG',
 'VT-IDH',
 'VT-IDI',
 'VT-IDJ',
 'VT-IDK',
 'VT-IDL',
 'VT-IDM',
 'VT-IDN',
 'VT-IDO',
 'VT-IDP',
 'VT-IDQ',
 'VT-IDR',
 'VT-IDS',
 'VT-IDT',
 'VT-IDU',
 'VT-IDV',
 'VT-IDW',
 'VT-IDX',
 'VT-IDY',
 'VT-IDZ',
 'VT-IEA',
 'VT-IEB',
 'VT-IEC',
 'VT-IED',
 'VT-IEE',
 'VT-IEF',
 'VT-IEG',
 'VT-IEH',
 'VT-IEI',
 'VT-IEJ',
 'VT-IEK',
 'VT-IEL',
 'VT-IEM',
 'VT-IEN',
 'VT-IEO',
 'VT-IEP',
 'VT-IEQ',
 'VT-IER',
 'VT-IES',
 'VT-IET',
 'VT-IEU',
 'VT-IEV',
 'VT-IEW',
 'VT-IEX',
 'VT-IEY',
 'VT-IEZ',
 'VT-IFA',
 'VT-IFB',
 'VT-IFC',
 'VT-IFD',
 'VT-IFE',
 'VT-IFF',
 'VT-IFG',
 'VT-IFH',
 'VT-IFI',
 'VT-IFJ',
 'VT-IFK',
 'VT-IFL',
 'VT-IFM',
 'VT-IFN',
 'VT-IFO',
 'VT-IFP',
 'VT-IFQ',
 'VT-IFR',
 'VT-IFS',
 'VT-IFT',
 'VT-IFU',
 'VT-IFV',
 'VT-IFW',
 'VT-IFX',
 'VT-IFY',
 'VT-IFZ',
 'VT-IGH',
 'VT-IGI',
 'VT-IGJ',
 'VT-IGK',
 'VT-IGL',
 'VT-IGS',
 'VT-IGT',
 'VT-IGU',
 'VT-IGV',
 'VT-IGW',
 'VT-IGX',
 'VT-IGY',
 'VT-IGZ',
 'VT-IHA',
 'VT-IHB',
 'VT-INP',
 'VT-INQ',
 'VT-INR',
 'VT-INS',
 'VT-INT',
 'VT-INU',
 'VT-INV',
 'VT-INX',
 'VT-INY',
 'VT-INZ',
 'VT-ITA',
 'VT-ITB',
 'VT-ITC',
 'VT-ITD',
 'VT-ITE',
 'VT-ITF',
 'VT-ITG',
 'VT-ITH',
 'VT-ITI',
 'VT-ITJ',
 'VT-ITK',
 'VT-ITL',
 'VT-ITM',
 'VT-ITN',
 'VT-ITO',
 'VT-ITS',
 'VT-SLA',
 'VT-SLB',
 'VT-SGG',
 'VT-SGH',
 'VT-SGJ',
 'VT-SGQ',
 'VT-SGV',
 'VT-SGX',
 'VT-SGY',
 'VT-SGZ',
 'VT-SLE',
 'VT-SLF',
 'VT-SLJ',
 'VT-SLL',
 'VT-SLM',
 'VT-SPF',
 'VT-SPK',
 'VT-SPP',
 'VT-SZA',
 'VT-SZB',
 'VT-SZI',
 'VT-SZJ',
 'VT-SZK',
 'VT-SZM',
 'VT-SZN',
 'VT-SLC',
 'VT-SLD',
 'VT-SPU',
 'VT-SZL',
 'VT-SUA',
 'VT-SUB',
 'VT-SUC',
 'VT-SUD',
 'VT-SUE',
 'VT-SUF',
 'VT-SUG',
 'VT-SUH',
 'VT-SUI',
 'VT-SUJ',
 'VT-SUK',
 'VT-SUL',
 'VT-SUM',
 'VT-SUO',
 'VT-SUP',
 'VT-SUQ',
 'VT-SUR',
 'VT-SUS',
 'VT-JWP',
 'VT-JWQ',
 'VT-JWV',
 'VT-JWW',
 'VT-JWR',
 'VT-JWS',
 'VT-JWT',
 'VT-JWU',
 'VT-JCJ',
 'VT-JCK',
 'VT-JCL',
 'VT-JCM',
 'VT-JCN',
 'VT-JCP',
 'VT-JCQ',
 'VT-JCR',
 'VT-JCS',
 'VT-JCT',
 'VT-JCU',
 'VT-JCV',
 'VT-JCW',
 'VT-JGX',
 'VT-JGY',
 'VT-JBB',
 'VT-JBC',
 'VT-JBD',
 'VT-JBE',
 'VT-JBF',
 'VT-JBG',
 'VT-JBH',
 'VT-JBJ',
 'VT-JBK',
 'VT-JBL',
 'VT-JBM',
 'VT-JBN',
 'VT-JBP',
 'VT-JBQ',
 'VT-JBR',
 'VT-JBS',
 'VT-JBU',
 'VT-JBV',
 'VT-JBW',
 'VT-JBX',
 'VT-JFA',
 'VT-JFB',
 'VT-JFC',
 'VT-JFD',
 'VT-JFE',
 'VT-JFF',
 'VT-JFG',
 'VT-JFH',
 'VT-JFJ',
 'VT-JFK',
 'VT-JFL',
 'VT-JFM',
 'VT-JFN',
 'VT-JFP',
 'VT-JFQ',
 'VT-JFR',
 'VT-JFS',
 'VT-JFT',
 'VT-JFW',
 'VT-JFX',
 'VT-JFY',
 'VT-JFZ',
 'VT-JGA',
 'VT-JGE',
 'VT-JGF',
 'VT-JGG',
 'VT-JGJ',
 'VT-JGK',
 'VT-JGP',
 'VT-JGQ',
 'VT-JGR',
 'VT-JGS',
 'VT-JGT',
 'VT-JGU',
 'VT-JGV',
 'VT-JGW',
 'VT-JNL',
 'VT-JTA',
 'VT-JTB',
 'VT-JTC',
 'VT-JTD',
 'VT-JBY',
 'VT-JBZ',
 'VT-JGC',
 'VT-JGD',
 'A6-JAE',
 'VT-JEH',
 'VT-JEK',
 'VT-JEM',
 'VT-JEQ',
 'VT-JES',
 'VT-JET',
 'VT-JEU',
 'VT-JEV',
 'VT-JEW',
 'VT-JEX',
 'VT-SCA',
 'VT-SCB',
 'VT-SCC',
 'VT-SCF',
 'VT-SCG',
 'VT-SCH',
 'VT-SCI',
 'VT-SCJ',
 'VT-SCK',
 'VT-SCL',
 'VT-SCM',
 'VT-SCN',
 'VT-SCO',
 'VT-SCP',
 'VT-SCQ',
 'VT-SCR',
 'VT-SCS',
 'VT-SCT',
 'VT-SCU',
 'VT-SCV',
 'VT-SCW',
 'VT-SCX',
 'VT-EDC',
 'VT-EDD',
 'VT-EDE',
 'VT-EDF',
 'VT-EPB',
 'VT-EPC',
 'VT-EPF',
 'VT-EPG',
 'VT-EPH',
 'VT-EPI',
 'VT-EPJ',
 'VT-ESB',
 'VT-ESC',
 'VT-ESD',
 'VT-ESE',
 'VT-ESF',
 'VT-ESG',
 'VT-ESI',
 'VT-ESJ',
 'VT-ESL',
 'VT-EXA',
 'VT-EXB',
 'VT-EXC',
 'VT-EXD',
 'VT-EXE',
 'VT-PPA',
 'VT-PPB',
 'VT-PPD',
 'VT-PPE',
 'VT-PPF',
 'VT-PPG',
 'VT-PPH',
 'VT-PPI',
 'VT-PPJ',
 'VT-PPK',
 'VT-PPL',
 'VT-PPM',
 'VT-PPN',
 'VT-PPO',
 'VT-PPQ',
 'VT-PPT',
 'VT-PPU',
 'VT-PPV',
 'VT-PPW',
 'VT-PPX',
 'VT-EGJ',
 'VT-ESO',
 'VT-ESP',
 'VT-EVA',
 'VT-EVB',
 'VT-ALF',
 'VT-ALG',
 'VT-ALH',
 'VT-ALJ',
 'VT-ALK',
 'VT-ALL',
 'VT-ALM',
 'VT-ALN',
 'VT-ALO',
 'VT-ALP',
 'VT-ALQ',
 'VT-ALR',
 'VT-ALS',
 'VT-ALT',
 'VT-ALU',
 'VT-ANA',
 'VT-ANB',
 'VT-ANC',
 'VT-AND',
 'VT-ANE',
 'VT-ANG',
 'VT-ANH',
 'VT-ANI',
 'VT-ANJ',
 'VT-ANK',
 'VT-ANL',
 'VT-ANM',
 'VT-ANN',
 'VT-ANO',
 'VT-ANP',
 'VT-ANQ',
 'VT-ANR',
 'VT-ANS',
 'VT-ANT',
 'VT-ANU',
 'VT-ANV',
 'VT-ANW',
 'VT-ANX',
 'VT-AXH',
 'VT-AXI',
 'VT-AXJ',
 'VT-AXM',
 'VT-AXN',
 'VT-AXP',
 'VT-AXQ',
 'VT-AXR',
 'VT-AXT',
 'VT-AXU',
 'VT-AXW',
 'VT-AXX',
 'VT-AXZ',
 'VT-AYA',
 'VT-AYB',
 'VT-AYC',
 'VT-AYD',
 'VT-GHA',
 'VT-GHB',
 'VT-GHC',
 'VT-GHD',
 'VT-GHE',
 'VT-GHF',
 'VT-GOI',
 'VT-GOJ',
 'VT-GOK',
 'VT-GOL',
 'VT-GOM',
 'VT-GON',
 'VT-GOO',
 'VT-GOP',
 'VT-GOQ',
 'VT-GOR',
 'VT-WAF',
 'VT-WAG',
 'VT-WAH',
 'VT-WAI',
 'VT-WAJ',
 'VT-WAK',
 'VT-WAL',
 'VT-WGA',
 'VT-WGB',
 'VT-WGC',
 'VT-WGD',
 'VT-WGE',
 'VT-APJ',
 'VT-ATB',
 'VT-ATF',
 'VT-BLR',
 'VT-HYD',
 'VT-JRT',
 'VT-PNQ',
 'VT-RED',
 'VT-TTB',
 'VT-TTC',
 'VT-TTD',
 'VT-TTE',
 'VT-TTF',
 'VT-TTG',
 'VT-TTH',
 'VT-TTI',
 'VT-TTJ',
 'VT-TTK',
 'VT-TTL',
 'VT-TTM',
 'VT-TTN',
 'VT-CMA',
 'VT-JDC',
 'VT-JDD',
 'VT-JCX',
 'VT-JCY',
 'VT-JCZ',
 'VT-JLB',
 'VT-SIZ',
 'VT-SJA',
 'VT-JLE',
 'VT-JLF',
 'VT-SJI',
 'VT-SJJ',
 'VT-JLH',
 'VT-JLJ',
 'VT-CID',
 'VT-EXF',
 'VT-ITP',
 'VT-SLG']
#test_tail=['VT-IAL', 'VT-IAN', 'VT-IAO', 'VT-IAP', 'VT-IAQ', 'VT-IAR', 'VT-IAS', 'VT-IAX', 'VT-IAY', 'VT-IDA', 'VT-IDB', 'VT-IDC', 'VT-IDD', 'VT-IDE', 'VT-IDF', 'VT-IDG', 'VT-IDH', 'VT-IDI', 'VT-IDJ', 'VT-IDK', 'VT-IDL', 'VT-IDM', 'VT-IDN', 'VT-IDO', 'VT-IDP', 'VT-IDQ', 'VT-IDR', 'VT-IDS', 'VT-IDT', 'VT-IDU', 'VT-IDV', 'VT-IDW', 'VT-IDX', 'VT-IDY', 'VT-IDZ', 'VT-IEA', 'VT-IEB', 'VT-IEC', 'VT-IED', 'VT-IEE', 'VT-IEF', 'VT-IEG', 'VT-IEH', 'VT-IEI', 'VT-IEJ', 'VT-IEK', 'VT-IEL', 'VT-IEM', 'VT-IEN', 'VT-IEO', 'VT-IEP', 'VT-IEQ', 'VT-IER', 'VT-IES', 'VT-IET', 'VT-IEU', 'VT-IEV', 'VT-IEW', 'VT-IEX', 'VT-IEY', 'VT-IEZ', 'VT-IFA', 'VT-IFB', 'VT-IFC', 'VT-IFD', 'VT-IFE', 'VT-IFF', 'VT-IFG', 'VT-IFH', 'VT-IFI', 'VT-IFJ', 'VT-IFK', 'VT-IFL', 'VT-IFM', 'VT-IFN', 'VT-IFO', 'VT-IFP', 'VT-IFQ', 'VT-IFR', 'VT-IFS', 'VT-IFT', 'VT-IFU', 'VT-IFV', 'VT-IFW', 'VT-IFX', 'VT-IFY', 'VT-IFZ', 'VT-IGH', 'VT-IGI', 'VT-IGJ', 'VT-IGK', 'VT-IGL', 'VT-IGS', 'VT-IGT', 'VT-IGU', 'VT-IGV', 'VT-IGW', 'VT-IGX', 'VT-IGY', 'VT-IGZ', 'VT-IHA', 'VT-IHB', 'VT-INP', 'VT-INQ', 'VT-INR', 'VT-INS', 'VT-INT', 'VT-INU', 'VT-INV', 'VT-INX', 'VT-INY', 'VT-INZ', 'VT-ITA', 'VT-ITB', 'VT-ITC', 'VT-ITD', 'VT-ITE', 'VT-ITF', 'VT-ITG', 'VT-ITH', 'VT-ITI', 'VT-ITJ', 'VT-ITK', 'VT-ITL', 'VT-ITM', 'VT-ITN', 'VT-ITO', 'VT-ITS', 'VT-SLA', 'VT-SLB', 'VT-SGG', 'VT-SGH', 'VT-SGJ', 'VT-SGQ', 'VT-SGV', 'VT-SGX', 'VT-SGY', 'VT-SGZ', 'VT-SLE', 'VT-SLF', 'VT-SLJ', 'VT-SLL', 'VT-SLM', 'VT-SPF', 'VT-SPK', 'VT-SPP', 'VT-SZA', 'VT-SZB', 'VT-SZI', 'VT-SZJ', 'VT-SZK', 'VT-SZM', 'VT-SZN', 'VT-SLC', 'VT-SLD', 'VT-SPU', 'VT-SZL', 'VT-SUA', 'VT-SUB', 'VT-SUC', 'VT-SUD', 'VT-SUE', 'VT-SUF', 'VT-SUG', 'VT-SUH', 'VT-SUI', 'VT-SUJ', 'VT-SUK', 'VT-SUL', 'VT-SUM', 'VT-SUO', 'VT-SUP', 'VT-SUQ', 'VT-SUR', 'VT-SUS', 'VT-JWP', 'VT-JWQ', 'VT-JWV', 'VT-JWW', 'VT-JWR', 'VT-JWS', 'VT-JWT', 'VT-JWU', 'VT-JCJ', 'VT-JCK', 'VT-JCL', 'VT-JCM', 'VT-JCN', 'VT-JCP', 'VT-JCQ', 'VT-JCR', 'VT-JCS', 'VT-JCT', 'VT-JCU', 'VT-JCV', 'VT-JCW', 'VT-JGX', 'VT-JGY', 'VT-JBB', 'VT-JBC', 'VT-JBD', 'VT-JBE', 'VT-JBF', 'VT-JBG', 'VT-JBH', 'VT-JBJ', 'VT-JBK', 'VT-JBL', 'VT-JBM', 'VT-JBN', 'VT-JBP', 'VT-JBQ', 'VT-JBR', 'VT-JBS', 'VT-JBU', 'VT-JBV', 'VT-JBW', 'VT-JBX', 'VT-JFA', 'VT-JFB', 'VT-JFC', 'VT-JFD', 'VT-JFE', 'VT-JFF', 'VT-JFG', 'VT-JFH', 'VT-JFJ', 'VT-JFK', 'VT-JFL', 'VT-JFM', 'VT-JFN', 'VT-JFP', 'VT-JFQ', 'VT-JFR', 'VT-JFS', 'VT-JFT', 'VT-JFW', 'VT-JFX', 'VT-JFY', 'VT-JFZ', 'VT-JGA', 'VT-JGE', 'VT-JGF', 'VT-JGG', 'VT-JGJ', 'VT-JGK', 'VT-JGP', 'VT-JGQ', 'VT-JGR', 'VT-JGS', 'VT-JGT', 'VT-JGU', 'VT-JGV', 'VT-JGW', 'VT-JNL', 'VT-JTA', 'VT-JTB', 'VT-JTC', 'VT-JTD', 'VT-JBY', 'VT-JBZ', 'VT-JGC', 'VT-JGD', 'A6-JAE', 'VT-JEH', 'VT-JEK', 'VT-JEM', 'VT-JEQ', 'VT-JES', 'VT-JET', 'VT-JEU', 'VT-JEV', 'VT-JEW', 'VT-JEX', 'VT-SCA', 'VT-SCB', 'VT-SCC', 'VT-SCF', 'VT-SCG', 'VT-SCH', 'VT-SCI', 'VT-SCJ', 'VT-SCK', 'VT-SCL', 'VT-SCM', 'VT-SCN', 'VT-SCO', 'VT-SCP', 'VT-SCQ', 'VT-SCR', 'VT-SCS', 'VT-SCT', 'VT-SCU', 'VT-SCV', 'VT-SCW', 'VT-SCX', 'VT-EDC', 'VT-EDD', 'VT-EDE', 'VT-EDF', 'VT-EPB', 'VT-EPC', 'VT-EPF', 'VT-EPG', 'VT-EPH', 'VT-EPI', 'VT-EPJ', 'VT-ESB', 'VT-ESC', 'VT-ESD', 'VT-ESE', 'VT-ESF', 'VT-ESG', 'VT-ESI', 'VT-ESJ', 'VT-ESL', 'VT-EXA', 'VT-EXB', 'VT-EXC', 'VT-EXD', 'VT-EXE', 'VT-PPA', 'VT-PPB', 'VT-PPD', 'VT-PPE', 'VT-PPF', 'VT-PPG', 'VT-PPH', 'VT-PPI', 'VT-PPJ', 'VT-PPK', 'VT-PPL', 'VT-PPM', 'VT-PPN', 'VT-PPO', 'VT-PPQ', 'VT-PPT', 'VT-PPU', 'VT-PPV', 'VT-PPW', 'VT-PPX', 'VT-EGJ', 'VT-ESO', 'VT-ESP', 'VT-EVA', 'VT-EVB', 'VT-ALF', 'VT-ALG', 'VT-ALH', 'VT-ALJ', 'VT-ALK', 'VT-ALL', 'VT-ALM', 'VT-ALN', 'VT-ALO', 'VT-ALP', 'VT-ALQ', 'VT-ALR', 'VT-ALS', 'VT-ALT', 'VT-ALU', 'VT-ANA', 'VT-ANB', 'VT-ANC', 'VT-AND', 'VT-ANE', 'VT-ANG', 'VT-ANH', 'VT-ANI', 'VT-ANJ', 'VT-ANK', 'VT-ANL', 'VT-ANM', 'VT-ANN', 'VT-ANO', 'VT-ANP', 'VT-ANQ', 'VT-ANR', 'VT-ANS', 'VT-ANT', 'VT-ANU', 'VT-ANV', 'VT-ANW', 'VT-ANX', 'VT-AXH', 'VT-AXI', 'VT-AXJ', 'VT-AXM', 'VT-AXN', 'VT-AXP', 'VT-AXQ', 'VT-AXR', 'VT-AXT', 'VT-AXU', 'VT-AXW', 'VT-AXX', 'VT-AXZ', 'VT-AYA', 'VT-AYB', 'VT-AYC', 'VT-AYD', 'VT-GHA', 'VT-GHB', 'VT-GHC', 'VT-GHD', 'VT-GHE', 'VT-GHF', 'VT-GOI', 'VT-GOJ', 'VT-GOK', 'VT-GOL', 'VT-GOM', 'VT-GON', 'VT-GOO', 'VT-GOP', 'VT-GOQ', 'VT-GOR', 'VT-WAF', 'VT-WAG', 'VT-WAH', 'VT-WAI', 'VT-WAJ', 'VT-WAK', 'VT-WAL', 'VT-WGA', 'VT-WGB', 'VT-WGC', 'VT-WGD', 'VT-WGE', 'VT-APJ', 'VT-ATB', 'VT-ATF', 'VT-BLR', 'VT-HYD', 'VT-JRT', 'VT-PNQ', 'VT-RED', 'VT-TTB', 'VT-TTC', 'VT-TTD', 'VT-TTE', 'VT-TTF', 'VT-TTG', 'VT-TTH', 'VT-TTI', 'VT-TTJ', 'VT-TTK', 'VT-TTL', 'VT-TTM', 'VT-TTN', 'VT-CMA', 'VT-JDC', 'VT-JDD', 'VT-JCX', 'VT-JCY', 'VT-JCZ', 'VT-JLB', 'VT-SIZ', 'VT-SJA', 'VT-JLE', 'VT-JLF', 'VT-SJI', 'VT-SJJ', 'VT-JLH', 'VT-JLJ']
fetched=[]
unfetched=[]

again=['VT-SUA', 'VT-SUC', 'VT-JBG', 'VT-JBP', 'VT-JFT','VT-JNL', 'A6-JAE', 'VT-SCA', 'VT-EPB', 'VT-EPC', 'VT-EPG', 'VT-EPH', 'VT-EPI', 'VT-ESB', 'VT-ESC', 'VT-ESG', 'VT-ESJ', 'VT-PPQ', 'VT-EGJ', 'VT-ESP','VT-ALK', 'VT-ANA', 'VT-ANC', 'VT-AXT', 'VT-GOK', 'VT-ATB', 'VT-CMA', 'VT-JLB']
#test_tail=['VT-IAL', 'VT-IAN', 'VT-IAO', 'VT-IAP', 'VT-IAQ']
for tail in again_1:
#for tail in updated_tail:
#for tail in ['VT-ANK','VT-ANA','VT-ALP','VT-ANR','VT-INU','VT-AYA']:
    data=get_history_by_tail_number(tail)
    time.sleep(7)
    print(len(data),tail)
    
    if len(data)>0:
        df=pd.DataFrame(data)
        fetched+=df.to_dict('records')
        print(len(fetched))
    else:
        unfetched.append(tail)
        #print(len(list(collection_1.find())))
    
#collection_1.insert_many(df.to_dict('records'))  
collection_1.insert_many(fetched)
#print(len(list(collection_1.find({})))) 
print(unfetched)   

